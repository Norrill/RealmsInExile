# Faction demand events
namespace = lotr_faction_demand

# Orc Revolt Faction Demand
# by Fredsch

lotr_faction_demand.2000 = {
	type = character_event
	sender = scope:orc_revolt_leader
	title = "FACTION_DEMAND_ORC_REVOLT"
	desc = FACTION_DEMAND_ORC_REVOLT_DESC
	theme = battle
	right_portrait = {
		character = scope:orc_revolt_leader
		animation = aggressive_sword
	}

	trigger = {
		exists = scope:faction
		exists = scope:orc_revolt_leader
		scope:orc_revolt_leader.joined_faction = scope:faction
	}

	on_trigger_fail = {
		debug_log = "Orc Revolt Faction tried to press claim (probably) without existing orc_revolt_leader"
		debug_log_scopes = yes
		debug_log = "Orc Revolt Faction error reporting complete"
	}

	option = {
		name = "FACTION_DEMAND_ORC_REVOLT_ACCEPT"
		orc_rebellion_faction_demands_enforced = {
			FACTION_LEADER = scope:orc_revolt_leader
			TARGET_TITLE = scope:target_title
			SOURCE_GOVERNMENT = root
		}

		ai_chance = {
			base = 0
			ai_value_modifier = {
				ai_boldness = -4
			}
			modifier = {
				add = 50
				scope:faction = { faction_power >= 100 }
			}
			modifier = {
				add = 50
				scope:faction = { faction_power >= 110 }
			}
			modifier = {
				add = 50
				scope:faction = { faction_power >= 120 }
			}
			modifier = {
				add = 50
				scope:faction = { faction_power >= 130 }
			}
			modifier = {
				add = 50
				scope:faction = { faction_power >= 140 }
			}
			modifier = {
				add = 50
				scope:faction = { faction_power >= 150 }
			}
			modifier = {
				add = -50
				scope:faction.faction_target = {
					is_at_war = no
					primary_title.tier >= tier_kingdom
				}
			}
			modifier = {
				add = -150
				scope:faction.faction_target = {
					is_at_war = no
					primary_title.tier >= tier_empire
				}
			}
		}
	}

	option = {
		name = "FACTION_DEMAND_ORC_REVOLT_REFUSE"

		scope:faction = {
			faction_start_war = {}
			
			# This needs to run after 'faction_start_war' or the troops won't spawn correctly.
			faction_spawn_member_county_armies_effect = {
				FACTION = scope:faction
				ARMY_OWNER = scope:orc_revolt_leader
				PEASANT_ARMY_NAME = orc_rebellion_faction_event_troops
			}	
		}

		ai_chance = {
			base = 100
			ai_value_modifier = {
				ai_boldness = 4
			}
			modifier = {
				add = 50
				scope:faction = { faction_power < 90 }
			}
			modifier = {
				add = 50
				scope:faction = { faction_power < 80 }
			}
		}
	}
}
